alert:
- debug
description: Rule for thehive
filter:
- query_string:
    query: (signal.status:"in-progress" AND event.module:"suricata")
index: .siem-signals-default
category:
- Detection
- Signal
name: TheHive_Suricata
priority: 3
realert:
  minutes: 0
title: Rule for TheHive Suricata
type: any



alert: hivealerter

hive_alert_config:
 title: '{match[signal][rule][name]}'
 type: '{match[event][module]}'
 source: '{match[host][name]}'
 description: "`Rule description :` \n\n {match[suricata][eve][alert][category]} \n\n `Event Original :` \n\n '{match[signal][original_event][original]} \n\n `Lien Kibana :` \n\n http://KIBANA_IP/kibana/app/kibana#/discover?_g=(filters:!())&_a=(columns:!(_source),filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'88a2ee30-9e7a-11eb-9a55-ff4842811a9a',key:_id,negate:!f,params:(query:'{match[_id]}'),type:phrase,value:'{match[_id]}'),query:(match:(_id:(query:'{match[_id]}',type:phrase))))),index:'88a2ee30-9e7a-11eb-9a55-ff4842811a9a',interval:auto,query:(language:kuery,query:''),sort:!(!('@timestamp',desc))))"
 severity: 3
 tags: ['Signal', 'Detection']
 tlp: 2
 status: 'New'
 follow: True

hive_observable_data_mapping:
 - hash: "{match[hash][sha1]}"
 - hash: "{match[hash][md5]}"
 - hash: "{match[hash][sha256]}"
 - domain: "{match[dns][question][name]}"
 - ip: "{match[source][ip]}"
 - ip: "{match[destination][ip]}"
